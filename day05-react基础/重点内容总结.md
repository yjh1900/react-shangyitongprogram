## 组件通讯

- pubsub-js 是一个独立 js 库. 不考虑组件关系的情况下随意的传递数据

pubsub-js 基于发布订阅的设计思想封装的 js 库

### 使用:

1. 下载 npm i pubsub-js

2. 在需要发布数据的组件中,执行代码

   ```js
   import PubSub from 'pubsub-js'
   PubSub.publish('话题', 数据)
   ```

3. 在需要接收数据的组件中,订阅

   ```js
   import PubSub from 'pubsub-js'
   const id = PubSub.subscribe('话题', (话题, 接收的数据) => {
     // 当订阅的话题被发布了,这个回调函数会自动被调用
   })
   ```

   注意: 每一个订阅,都会返回一个值,这个值就是当前订阅的唯一 id

4. 清除订阅

   ```js
   import PubSub from 'pubsub-js'

   PubSub.unsubscribe(指定订阅的 id)
   ```

5. 清除订阅的了解内容

   ```js
   PubSub.unsubscribe(话题) //清除当前话题的所有订阅
   PubSub.clearAllSubscriptions() //清除所有的订阅
   ```

## 组件的生命周期

组件的生命周期钩子函数
注意: 函数组件和类组件都有生命周期.但是只有类组件有生命周期钩子函数,函数组件没有钩子函数

### 类组件常用的生命周期钩子函数

1. 挂载阶段 (只执行一次)

   constructor 定义个状态
   render 解析 jsx 注意: 千万不要在 render 中直接调用 setState
   componentDidMount 订阅,发 ajax(只要是组件创建成功就要执行一次的代码)

2. 更新阶段(执行多次)
   触发的三个条件: 1. 父组件更新 2. 自己调用了 setState 3. forceUpdate(强制更新.不用)
   render
   componentDidUpdate 注意: 千万不要在 componentDidUpdate 中直接调用 setState

3. 卸载阶段(只执行一次)
   componentWillUnmount 清除操作
